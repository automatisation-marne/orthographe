<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Conjuguer "aller" - CE1</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    #consigne { font-size: 20px; margin-bottom: 20px; }
    #phrase { font-size: 24px; margin: 20px; }
    #clavier { display: flex; flex-wrap: wrap; max-width: 400px; margin: 20px auto; }
    .touche {
      width: 40px; height: 40px; margin: 4px;
      font-size: 20px; text-align: center; line-height: 40px;
      background: #eee; border: 1px solid #ccc; cursor: pointer;
    }
    #inputZone {
      font-size: 24px; padding: 5px; width: 200px; text-align: center;
      margin: 10px auto; border: 2px solid #888;
    }
    button { padding: 10px 20px; font-size: 18px; margin: 10px; }
    .valider { background-color: #4CAF50; color: white; }
    .terminer { background-color: #f44336; color: white; }
    #feedback { font-size: 20px; margin-top: 10px; }
  </style>
</head>
<body>
 <div id="consigne">Conjugue le verbe indiqué entre parenthèses au <b>futur simple</b>.</div>
 <div id="phrase"></div>
 <div><input type="text" id="inputZone" readonly /></div>


  <div id="clavier"></div>

  <button class="valider" onclick="valider()">Valider</button>
  <button id="suivantBtn" onclick="suivant()" style="display:none">Phrase suivante</button>
  <button class="terminer" onclick="confirmerFin()">Terminer l'exercice</button>

  <div id="feedback"></div>
  <div id="score"></div>

<script>

const phrases = [
  "Je __ un gâteau pour l'anniversaire. (préparer)|préparerai",
  "Tu __ ton cartable avant de partir. (porter)|porteras",
  "Il __ un dessin pour sa maman. (dessiner)|dessinera",
  "Nous __ un jeu ensemble à la récréation. (inventer)|inventerons",
  "Vous __ une lettre au Père Noël. (écrire)|écrirez",
  "Elles __ les fleurs du jardin. (cueillir)|cueilleront",
  "Mon frère __ les jouets dans le coffre. (ranger)|rangera",
  "Les enfants __ dans la cour. (jouer)|joueront",
  "Ma sœur et moi __ une histoire drôle. (raconter)|raconterons",
  "Tu __ la table pour le dîner. (dresser)|dresseras",
  "Il __ le ballon dans le but. (lancer)|lancera",
  "Nous __ une chanson pour la fête. (chanter)|chanterons",
  "Vous __ le couloir de l’école. (balayer)|balayerez",
  "Je __ mon cahier de devoirs. (remplir)|remplirai",
  "Ils __ un spectacle de marionnettes. (préparer)|prépareront",
  "Elle __ les couleurs sur la palette. (mélanger)|mélangera",
  "Tu __ une belle surprise. (préparer)|prépareras",
  "Nous __ les plantes du potager. (arroser)|arroserons",
  "Vous __ un cadeau pour votre copain. (fabriquer)|fabriquerez",
  "Elles __ un gâteau au chocolat. (cuisiner)|cuisineront"
];



let index = 0;
let bonnes = 0;
let total = 0;
let aDéjàRéponduJuste = false;




function melanger(tab) {
  for (let i = tab.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [tab[i], tab[j]] = [tab[j], tab[i]];
  }
  return tab;
}

let phrasesMelangées = melanger([...phrases]);

function afficherPhrase() {
  aDéjàRéponduJuste = false;
aDéjàTenté = false;
  document.getElementById("inputZone").value = "";
  document.getElementById("feedback").innerText = "";
  document.getElementById("suivantBtn").style.display = "none";
  const [texte] = phrasesMelangées[index].split("|");
  document.getElementById("phrase").innerText = texte.replace("__", "_____");
}

function valider() {
  const [_, reponse] = phrasesMelangées[index].split("|");
  const saisie = document.getElementById("inputZone").value.trim().toLowerCase();

  if (saisie === reponse) {
    document.getElementById("feedback").innerText = "Bravo, bonne réponse !";
    if (!aDéjàRéponduJuste) {
      bonnes++;
      total++;
      aDéjàRéponduJuste = true;
    }
    document.getElementById("suivantBtn").style.display = "inline-block";
  } else {
    document.getElementById("feedback").innerText = "Essaie encore.";
  }
}



function suivant() {
  if (index < phrasesMelangées.length - 1) {
    index++;
    afficherPhrase();
  } else {
    confirmerFin();
  }
}

function confirmerFin() {
  if (confirm("Attention, si tu cliques ici, l'exercice sera terminé et tu ne pourras plus écrire de phrases.")) {
    terminer();
  }
}

function terminer() {
  document.getElementById("score").innerText = "";
  document.getElementById("phrase").innerText = "L'exercice est terminé.";
  document.getElementById("clavier").style.display = "none";
  document.getElementById("inputZone").style.display = "none";
  document.getElementById("suivantBtn").style.display = "none";
  const restartBtn = document.createElement("button");
  restartBtn.innerText = "Recommencer l'exercice";
  restartBtn.onclick = () => location.reload();
  restartBtn.style.marginTop = "20px";
  document.body.appendChild(restartBtn);
}



function appuyer(touche) {
  document.getElementById("inputZone").value += touche;
}

function creerClavier() {
  const lettres = [
    'a','b','c','d','e','f','g','h','i','j',
    'k','l','m','n','o','p','q','r','s','t',
    'u','v','w','x','y','z',
    'à','é','è','ê','ù',
    '<',' '
  ];
  const clavier = document.getElementById("clavier");
  lettres.forEach(t => {
    let btn = document.createElement("div");
    btn.className = "touche";
    btn.innerText = t;
    btn.onclick = () => {
      if (t === '<') {
        let zone = document.getElementById("inputZone");
        zone.value = zone.value.slice(0, -1);
      } else {
        appuyer(t);
      }
    };
    clavier.appendChild(btn);
  });
}

window.onload = function() {
  creerClavier();
  afficherPhrase();
};

</script>
</body>
</html>
